r9699 trunk/source