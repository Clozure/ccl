r8584 trunk/source