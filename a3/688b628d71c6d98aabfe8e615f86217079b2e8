r8582 trunk/source