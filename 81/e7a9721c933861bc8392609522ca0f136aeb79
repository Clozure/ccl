r12788 trunk/source