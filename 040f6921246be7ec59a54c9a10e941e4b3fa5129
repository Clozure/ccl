r8346 trunk/source