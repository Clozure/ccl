r12787 trunk/source