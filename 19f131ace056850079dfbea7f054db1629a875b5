r8585 trunk/source