r9696 trunk/source