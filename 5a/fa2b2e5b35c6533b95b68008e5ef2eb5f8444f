r9685 trunk/source