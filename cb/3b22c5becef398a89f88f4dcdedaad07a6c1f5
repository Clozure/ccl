r9787 trunk/source