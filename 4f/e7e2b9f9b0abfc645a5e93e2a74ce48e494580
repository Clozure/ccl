r15804 trunk/source